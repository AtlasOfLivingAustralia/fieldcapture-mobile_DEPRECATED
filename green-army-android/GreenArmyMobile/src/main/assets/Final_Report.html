

<!DOCTYPE html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
    <script src="static/t5OGphSUjwdNOoxNKgdRTTh1RBtmzhMXxHDYYeR4lYj.js" type="text/javascript" ></script>
<link href="static/doSKUivnfI9gXmPKZ2XG4W5xIABYgKaf5Dwf3LtjNVr.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/090onaZX1M508oSWqGmMeETZ9NkUA9p4CCTW3MUpRPc.css" type="text/css" rel="stylesheet" media="screen, projection" />

<link href="http://www.ala.org.au/wp-content/themes/ala2011/images/favicon.ico" rel="shortcut icon" />
<!--[if lt IE 9]><script src="static/Yh1Txee3hFzExJ4P1str7tGV24zQMEYtxqtlYJ5ukR0.js" type="text/javascript" ></script><![endif]-->
<link href="static/6tuLClj7N5eYCZpx7vLn8juIbQUXBkCnWRUJFY7UDCz.css" type="text/css" rel="stylesheet" media="screen,print" />
<link href="/static/7ARiB2rJgSkfi68hxnSlcG9Ot0gQ863DYxkCmSHQweE.png" rel="shortcut icon" />
<link href="/static/14SWTr4VqVh6tnlUlgBtue6IJZ7gwE1y42RT7ya5GGW.png" rel="shortcut icon" />

<link href="static/KYGDEVRRaKjNbTXJkHmicmzo9vFrnnzCnGLcxKjR04f.css" type="text/css" rel="stylesheet" media="screen,print" />

<link href="static/VySgOjkVOsD8Jt8ujXROVRjZeDLAAwVhMF5WqPZ8Ajf.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/oCB1sG1sF2mXmdGWbsKOQVtVlwI65xC1v4piNjgFVa5.css" type="text/css" rel="stylesheet" media="screen,print" />
<link href="static/oIrwT54gW9GPzlyUPklk7GudMUesT0i4uyNDAO2dwZ8.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="/static/RrjzrZ0Ci0GPLETIr8x8KUMjfJtZKvifrUtMCedwKRB.png" rel="shortcut icon" />
<link href="static/AcXIjLTuc87n8sfxBjJRQSoBIUwP9RnCyK8Sv82i7eV.css" type="text/css" rel="stylesheet" media="screen, projection" />
<script type="text/javascript">
    var fcConfig = {
        bieUrl: "http://bie.ala.org.au",
        speciesProfileUrl: "https://fieldcapture.ala.org.au/proxy/speciesProfile",
        googleStaticUrl:"http://maps.googleapis.com/maps/api/staticmap?maptype=terrian&zoom=12&sensor=false&size=350x250&markers=color:red%7C"
        },
        here = document.location.href;
    </script>
    

    <meta name="layout" content="mobile"/>

    
    

    <style type="text/css">
        input[type=checkbox] {  -webkit-transform: scale(1.5); }
        .checkbox-list label { min-height: 40px; }
        .speciesAutocompleteRow {min-height:40px;}
        .datepicker td, .datepicker th {
            width:40px;
            height:40px;
            vertical-align: middle;
        }
    </style>
</head>

<body>

<div id="content" class="clearfix">
    
<div class="container-fluid validationEngineContainer" id="validation-container">
<div id="koActivityMainBlock">

    <div class="row-fluid">
        <div class="span12">
            <!-- Common activity fields -->

            <div class="row-fluid space-after">
                <div class="span4">

                    <label class="for-readonly">Type</label>
                    <span class="readonly-text" data-bind="text:type"></span>
                </div>
                <div class="span8">

                    <label class="for-readonly">Description</label>
                    <span class="readonly-text" data-bind="text:description"></span>
                </div>
            </div>


            <div class="row-fluid space-after">
                <div class="span4">
                    <label class="for-readonly inline">Planned start date</label>
                    <span class="readonly-text" data-bind="text:plannedStartDate.formattedDate"></span>
                </div>
                <div class="span8">
                    <label class="for-readonly inline">Planned end date</label>
                    <span class="readonly-text" data-bind="text:plannedEndDate.formattedDate"></span>
                </div>
            </div>

            <div class="well">
                <div class="row-fluid">

                    <span class="span8">
                    <div class="row-fluid space-after">

                        <div class="span6 required">
                            <label for="startDate"><b>Actual start date</b>
                                <a href='#' class='helphover' data-original-title='Start date' data-placement='top' data-content='Date the activity was started.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a>
                            </label>


                            <div class="input-append">
                                <input data-bind='datepicker:startDate.date' name='startDate' id='startDate' type='text' size='16' class='input-xlarge' readonly='readonly' targetField='startDate.date' data-validation-engine='validate[required]' />
<span class='add-on open-datepicker'>
  <i class='icon-th'>&nbsp;</i>
</span>
                            </div>

                        </div>
                        <div class="span6" data-bind="css:{required:transients.markedAsFinished}">
                            <label for="endDate"><b>Actual end date</b>
                                <a href='#' class='helphover' data-original-title='End date' data-placement='top' data-content='Date the activity finished.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a>
                            </label>

                            <div class="input-append">
                                <input data-bind='datepicker:endDate.date' name='endDate' id='endDate' type='text' size='16' class='input-xlarge' readonly='readonly' targetField='endDate.date' data-validation-engine='validate[future[startDate]]' />
<span class='add-on open-datepicker'>
  <i class='icon-th'>&nbsp;</i>
</span>
                            </div>

                        </div>
                    </div>
                    <div class="row-fluid space-after">
                        <div class="span6">
                            <label for="theme"><b>Major theme</b></label>
                            <select id="theme" data-bind="value:mainTheme, options:transients.themes, optionsCaption:'Choose..'" class="input-xlarge" style="width:90%">
                            </select>
                        </div>

                        <div class="span6">
                            <label><b>Progress</b></label>
                            <label for="activityComplete"><input type="checkbox" id="activityComplete" data-bind="checked:transients.markedAsFinished" style="margin-right:1em;"><span>This activity is complete</span></label>

                        </div>

                    </div>
                    <div class="row-fluid">
                        <div class="span6">
                            <label for="site"><b>Site</b></label>
                            <select id='site' style='width:90%' data-bind='options:transients.sites,optionsText:"name",optionsValue:"siteId",value:siteId,optionsCaption:"Choose a site..."'>&nbsp;</select>

                        </div>

                        <div class="span3">

                            <button class="btn btn-info" style="margin-top:25px;" data-bind="visible:transients.newSiteSupported,click:createNewSite">Create new Site</button>
                        </div>
                    </div>

                    
                        
                            
                                
                            
                            
                                
                                    
                                    
                                    
                                    

                                
                            
                        

                    
                    </span>
                    <span class="span4">

                        <img id="siteLocationImage" width="100%" data-bind="event:{error:siteLoadError}, attr:{src:transients.siteImgUrl}, visible:transients.siteImgUrl()"/>


                    </span>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- ko stopBinding: true -->

    
    
    
    <style type="text/css">
        table.participatingOrganisations th {white-space:normal;}
        table.participatingOrganisations tbody td:nth-child(1) {width:40%;}
        table.participatingOrganisations tbody td:nth-child(1)
        table.participatingOrganisations tbody td:nth-child(2) {width:15;}
        table.participatingOrganisations tbody td:nth-child(2)
        table.participatingOrganisations tbody td:nth-child(3) {width:40%;}
        table.participatingOrganisations tbody td:nth-child(3)
        table.participatingOrganisations td:last-child {width:4%;text-align:center;}
        table.participatingOrganisations textarea {width:100%; box-sizing:border-box; }
        table.participatingOrganisations select {width:100%; box-sizing:border-box; }
    </style>
    <div class="output-block" id="koFinal_Report_Details">
            <h3 data-bind="css:{modified:dirtyFlag.isDirty},attr:{title:'Has been modified'}">Final Report Details</h3>
        <!-- add the dynamic components -->
        <div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>1. Summary of the Project and its Outcomes</h4></span></span></div>
<div class="row-fluid space-after output-section" >
<div class="span6">
<div class="row-fluid"><span class="span12">    <span  class="span4 checkbox-list-label  preLabel required"><label>1.1a Identify the agricultural features the project has addressed / benefited?<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Indicate which natural, agricultural and cultural features have been addressed and / or benefited by this project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span>
            <ul class="checkbox-list" data-bind="foreach: transients.projectGoalsAddressedConstraints">
                <li>
                    <label data-bind="attr:{'for': 'projectGoalsAddressed'+$index()+'-'+($parentContext.$index?$parentContext.$index():'')}"><input type="checkbox" name="data.projectGoalsAddressed" data-bind="value:$data,checked:$parent.data.projectGoalsAddressed,attr:{'id': 'projectGoalsAddressed'+$index()+'-'+($parentContext.$index?$parentContext.$index():''), 'name': 'projectGoalsAddressed'+'-'+($parentContext.$index?$parentContext.$index():'')}"  data-validation-engine='validate[minCheckbox[1]]'/><span data-bind="text:$data"/></label></span>
                </li>
            </ul>
        </span></div></div><div class="span6">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>1.1b If 'Other', describe the features benefited by the project<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='If &apos;Other&apos; was selected in 1.1a, describe what &apos;other&apos; features have benefited from implementation of this project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><textarea  class="span8" data-bind='value:data.projectGoalsAddressed_Other'></textarea></span></div></div></div>
<div class="row-fluid space-after output-section" >
<div class="span12">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>1.2 Provide a summary of the project's overall achievements against the Activities and Outcomes stated in the Funding Agreement and its contribution towards the Programme's Strategic Objectives and Outcomes.<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='State what this project has achieved (against the Activities and Outcomes stated in the Funding Agreement) and how it has contributed towards the Programme&apos;s Strategic Objectives and Outcomes.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><textarea  class="span8" data-bind='value:data.achievementsSummary'></textarea></span></div><div class="row-fluid"><span class="span12">    <span  class="span8"><h5>1.3 Provide the names of the various organisations that participated in your project and briefly describe how each contributed to the project.</h5></span></span></div><div class="row-fluid output-section">
            <table class="table table-bordered participatingOrganisations " >
                <thead><tr><th class="required">Organisation Name<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Name of contributing organisation'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th class="required">Organisation Type<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Type of contributing organisation'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th class="required">How the organisaton participated<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Describe how this organisation contributed to the project outcomes.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th></th>
                </tr></thead>
                <tbody data-bind="template:{name:'participatingOrganisationsviewTmpl', foreach: data.participatingOrganisations}"></tbody>
                <script id="participatingOrganisationsviewTmpl" type="text/html"><tr>
                    <td><input  class="input-large" data-bind='value:organisationName'  data-validation-engine='validate[required]' type='text' class='input-small'/></td>
                    <td><select data-bind='value:organisationType,options:transients.organisationTypeConstraints,optionsCaption:"Please select"' data-validation-engine='validate[required]'></select></td>
                    <td><textarea  data-bind='value:organisationContribution'></textarea></td>
                    <td><i data-bind='click:$root.removeparticipatingOrganisationsRow' class='icon-remove'></i></td>
                </tr></script>
                <tfoot>
                <tr><td colspan="0" style="text-align:left;">
                        <button type="button" class="btn btn-small" data-bind="click:addparticipatingOrganisationsRow">
                        <i class="icon-plus"></i> Add a row</button></td></tr> <script id="participatingOrganisationstemplate-upload" type="text/x-tmpl">{% %}</script>
                       <script id="participatingOrganisationstemplate-download" type="text/x-tmpl">{% %}</script>                </tfoot>
            </table>
        </div>
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>1.4 Describe the impact the grant has had on your own organisation and, if applicable, membership composition and numbers.<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Describe the impact the grant has had on your own organisation (and if applicable), membership composition and membership numbers.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><textarea  class="span8" data-bind='value:data.organisationImpact'></textarea></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>1.5 Are there any significant project achievements you would like to highlight?<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Indicate any significant achievements delivered by or resulting from implementing the project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><textarea  class="span8" data-bind='value:data.achievementsHighlights'></textarea></span></div></div></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>2. Monitoring, Evaluation and Project Learnings</h4></span></span></div>
<div class="row-fluid space-after output-section" >
<div class="span12">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>Provide a summary of a) what project monitoring and/or evaluation activities have been undertaken to date; b) any key findings and / or learnings gained from the project; and c) any changes you are making in response to these.<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='State what this project has achieved (against the Activities and Outcomes stated in the Funding Agreement) and how it has contributed towards the Programme&apos;s Strategic Objectives and Outcomes.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><textarea  class="span8" data-bind='value:data.achievementsSummary'></textarea></span></div></div></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>3. Other Comments</h4></span></span></div>
<div class="row-fluid space-after output-section" >
<div class="span12">
<div class="row-fluid"><span class="span12">    <span  class="span8">(Please provide any further comments you may wish to make on the project and / or programme here)</span></span></div><div class="row-fluid"><span class="span12">    <textarea  class="span8" data-bind='value:data.notes'></textarea></span></div></div></div>

        
    </div>
    

    
    
    
    <style type="text/css">
        table.pestManagement th {white-space:normal;}
        table.pestManagement tbody td:nth-child(1) {width:65%;}
        table.pestManagement tbody td:nth-child(1)
        table.pestManagement tbody td:nth-child(2) {width:15%;text-align:center;}
        table.pestManagement tbody td:nth-child(2)
        table.pestManagement tbody td:nth-child(3) {width:15%;text-align:center;}
        table.pestManagement tbody td:nth-child(3)
        table.pestManagement td:last-child {width:4%;text-align:center;}
        table.pestManagement textarea {width:100%; box-sizing:border-box; }
        table.pestManagement select {width:100%; box-sizing:border-box; }
    </style><style type="text/css">
        table.weedManagement th {white-space:normal;}
        table.weedManagement tbody td:nth-child(1) {width:80%;}
        table.weedManagement tbody td:nth-child(1)
        table.weedManagement tbody td:nth-child(2) {width:15%;text-align:center;}
        table.weedManagement tbody td:nth-child(2)
        table.weedManagement td:last-child {width:4%;text-align:center;}
        table.weedManagement textarea {width:100%; box-sizing:border-box; }
        table.weedManagement select {width:100%; box-sizing:border-box; }
    </style>
    <div class="output-block" id="koOutput_Details">
            <h3 data-bind="css:{modified:dirtyFlag.isDirty},attr:{title:'Has been modified'}">Output Details</h3>
        <!-- add the dynamic components -->
        <div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>4. Total Project Outputs</h4> (Please only report on outputs relevant to your project as defined in your Funding Agreement. You are not required to complete those outputs that are not relevant to your project.)</span></span></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h5>Actual Achievements - Physical Outputs</h5></span></span></div>
<div class="row-fluid space-after output-section" >
<div class="span6">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Area of Revegetation (Ha):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The area in hectares of the revegetation works area.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.areaRevegHa' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Plants planted (No.):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The total number of individual plants planted.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.totalNumberPlanted' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Survival rate (%):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The percentage of individual seedlings surviving at the time of follow-up survey as a proportion of numbers planted. The follow-up survey should be undertaken at least 3 (preferably 6) months after planting.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.percentSurvivalRate' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Seed collected	(Kg):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The weight of seed collected in kilograms.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.totalSeedCollectedKg' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Plant propagation (No.):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The total number of individual plants propagated.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.totalNumberGrown' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid ">
            <table class="table table-bordered pestManagement " >
                <thead><tr><th>Pest species managed	(name):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The pest species targeted for treatment (start typing a  scientific or common name for a species).'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Number of individuals/colonies treated:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of target pest animals or colonies of insects removed during this activity.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Area of pest animal treatment (Ha):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The area covered by treatment actions (Ha).'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th></th>
                </tr></thead>
                <tbody data-bind="template:{name:'pestManagementviewTmpl', foreach: data.pestManagement}"></tbody>
                <script id="pestManagementviewTmpl" type="text/html"><tr>
                    <td>
<span class="input-prepend input-append" data-bind="with:pestAnimalsTargetSpecies">
    <span class="add-on" data-bind="visible:!transients.editing(), css:{'btn-success':name()}"><i class="icon-white" data-bind="css:{'icon-ok':listId()!='unmatched' && name(), 'icon-question-sign':listId()=='unmatched' || listId() == 'error-unmatched'}"></i></span><span class="add-on" data-bind="visible:transients.editing()"><img src="static/Xo2jbaJ5EFqa59u9g4c4ybpCpw3wFWKhQdzZwNmmktO.gif" alt="saving icon" /></span><input type="text" data-bind="value:transients.textFieldValue,event:{focusout:focusLost},autocomplete:{url:'https://fieldcapture.ala.org.au/search/species', render: renderItem, listId: list, result:speciesSelected, valueChangeCallback:textFieldChanged}" />
    <span class="add-on" data-bind="visible: !transients.editing() && name()">
        <a href="#" data-bind="popover: {title: name, content: transients.speciesInformation}"><i class="icon-info-sign"></i></a>
    </span>
</span>
</td>
                    <td><input class="input-small" style="text-align:center" data-bind='value:pestAnimalsTreatedNo' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></td>
                    <td><input class="input-small" style="text-align:center" data-bind='value:pestAnimalsAreaTreatedHa' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></td>
                    <td><i data-bind='click:$root.removepestManagementRow' class='icon-remove'></i></td>
                </tr></script>
                <tfoot>
                <tr><td colspan="0" style="text-align:left;">
                        <button type="button" class="btn btn-small" data-bind="click:addpestManagementRow">
                        <i class="icon-plus"></i> Add a row</button></td></tr> <script id="pestManagementtemplate-upload" type="text/x-tmpl">{% %}</script>
                       <script id="pestManagementtemplate-download" type="text/x-tmpl">{% %}</script>                </tfoot>
            </table>
        </div>
</div><div class="span6">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Erosion area treated (Ha):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Area in hectares of erosion treated by this activity.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.erosionAreaTreated' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Area of land with improved management practices implemented (Ha):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The area of land in hectares on which changed management practices are implemented.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.changePracticeTreatedArea' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Did the project work across tenure?:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Indicate whether the project was undertaken on multiple (Yes) or single (No) tenures.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><select class="span8" data-bind='value:data.crossTenure,options:transients.crossTenureConstraints,optionsCaption:"Please select"'></select></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Length of fence erected (Km):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The length of fence erected in kilometres.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.lengthOfFence' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid ">
            <table class="table table-bordered weedManagement " >
                <thead><tr><th>Weed species managed	(name):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The plant species being targeted for treatment (start typing a  scientific or common name for a species).'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Area of weed treatment (Ha):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The area in hectares of the patch of the target species being treated.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th></th>
                </tr></thead>
                <tbody data-bind="template:{name:'weedManagementviewTmpl', foreach: data.weedManagement}"></tbody>
                <script id="weedManagementviewTmpl" type="text/html"><tr>
                    <td>
<span class="input-prepend input-append" data-bind="with:weedsTargetSpecies">
    <span class="add-on" data-bind="visible:!transients.editing(), css:{'btn-success':name()}"><i class="icon-white" data-bind="css:{'icon-ok':listId()!='unmatched' && name(), 'icon-question-sign':listId()=='unmatched' || listId() == 'error-unmatched'}"></i></span><span class="add-on" data-bind="visible:transients.editing()"><img src="static/Xo2jbaJ5EFqa59u9g4c4ybpCpw3wFWKhQdzZwNmmktO.gif" alt="saving icon" /></span><input type="text" data-bind="value:transients.textFieldValue,event:{focusout:focusLost},autocomplete:{url:'https://fieldcapture.ala.org.au/search/species', render: renderItem, listId: list, result:speciesSelected, valueChangeCallback:textFieldChanged}" />
    <span class="add-on" data-bind="visible: !transients.editing() && name()">
        <a href="#" data-bind="popover: {title: name, content: transients.speciesInformation}"><i class="icon-info-sign"></i></a>
    </span>
</span>
</td>
                    <td><input class="input-small" style="text-align:center" data-bind='value:weedsAreaTreatedHa' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></td>
                    <td><i data-bind='click:$root.removeweedManagementRow' class='icon-remove'></i></td>
                </tr></script>
                <tfoot>
                <tr><td colspan="0" style="text-align:left;">
                        <button type="button" class="btn btn-small" data-bind="click:addweedManagementRow">
                        <i class="icon-plus"></i> Add a row</button></td></tr> <script id="weedManagementtemplate-upload" type="text/x-tmpl">{% %}</script>
                       <script id="weedManagementtemplate-download" type="text/x-tmpl">{% %}</script>                </tfoot>
            </table>
        </div>
</div></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h5>Actual Achievements - Community, Social and Indigenous Outputs</h5></span></span></div>
<div class="row-fluid space-after output-section" >
<div class="span4">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Enhancing Community Skills and Knowledge (No.):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of skills development activities undertaken.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.skillsDevelopmentActivitiesNo' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 checkbox-list-label  preLabel"><label>Types of training undertaken:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The general type(s) of formal training undertaken to develop skills.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span>
            <ul class="checkbox-list" data-bind="foreach: transients.typeOfCourseConstraints">
                <li>
                    <label data-bind="attr:{'for': 'typeOfCourse'+$index()+'-'+($parentContext.$index?$parentContext.$index():'')}"><input type="checkbox" name="data.typeOfCourse" data-bind="value:$data,checked:$parent.data.typeOfCourse,attr:{'id': 'typeOfCourse'+$index()+'-'+($parentContext.$index?$parentContext.$index():''), 'name': 'typeOfCourse'+'-'+($parentContext.$index?$parentContext.$index():'')}" /><span data-bind="text:$data"/></label></span>
                </li>
            </ul>
        </span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of farming/fisher entities adopting sustainable practice change:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of farming entities adopting the specified changed management practices.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.entitiesAdoptingChange' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of farming/fisher entities involved in delivery of project activities:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The total number of unique farming/fisher entities participating in the project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.numberOfFarmingEntitiesParticipating' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div></div><div class="span4">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of Workshops/Field Days events:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of community, promotion and/or awareness raising/knowledge sharing events undertaken for the project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.numberOfEvents' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of Public Surveys:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of surveys undertaken to inform understanding of public awareness, knowledge, opinions, etc.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.publicSurveysNo' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of Surveys:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of surveys undertaken to monitor biodiversity and ecological assets.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.surveysNo' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of volunteers who participated in the delivery of project activities:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of people involved in the project who are not delivery partners or employed in the project. These would typically be the volunteer participants.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.numberOfVolunteers' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of community groups that participated in delivery of the project:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of different community groups (non delivery partners) participating in this project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.numberOfCommunityGroups' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div></div><div class="span4">
<div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of Indigenous participants involved in delivery of project activities (excluding those employed):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of Indigenous people participating in the project who are not delivery partners or employed in the project (ie. Indigenous volunteers).'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.numberOfIndigenousParticipants' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of Indigenous people employed/sub-contracted:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The total number of Indigenous people employed on the project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.totalIndigenousEmployees' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>No. of Indigenous Land and Sea Plans completed:<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The total number of Indigenous Land and Sea Plans developed by the project.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.indigenousPlansCompleted' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>Indigenous Ecological Knowledge (No. of publications/products developed):<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The total number of publications and other products (eg. videos) developed by the project to facilitate the sharing of Indigenous Ecological Knowledge.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><input class="input-small" style="text-align:center" data-bind='value:data.indigenousProductsDeveloped' data-validation-engine='validate[custom[number],min[0]]' type='number' class='input-mini'/></span></div></div></div>

        
    </div>
    

    
    
    
    
    <div class="output-block" id="koProject_Acquittal">
            <h3 data-bind="css:{modified:dirtyFlag.isDirty},attr:{title:'Has been modified'}">Project Acquittal</h3>
        <!-- add the dynamic components -->
        <div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>5. Project Income and Expenditure</h4></span></span></div>
<div class="row-fluid space-after output-section" >
<div class="span12">
<div class="row-fluid"><span class="span12">    <span  class="span8">Submission of financial acquittal documentation for the project is a Funding Agreement requirement and forms part of your final report submission. Templates are available from the Department.</span></span></div><div class="row-fluid"><span class="span12">    <span  class="span8">Scanned copies of completed and signed documents may be attached (<b> via the ADMIN > Project documents tab</b>) to this report or emailed to the Department. Alternatively, hard copies may forwarded to the Department.</span></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>5.1 Has your project fully achieved the objectives for which it was funded and have all funds been spent?<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Indicate whether your project fully achieved everything you expected it to achieve and also whether all of the project funds were spent.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><select class="span8" data-bind='value:data.projectAcquittal,options:transients.projectAcquittalConstraints,optionsCaption:"Please select"' data-validation-engine='validate[required]'></select></span></div><div class="row-fluid"><span class="span12">    <span  class="span8">If 'No', please contact the Department prior to completing your acquittal documentation and submitting your final report.</span></span></div><div class="row-fluid"><span class="span12">    <span  class="span8"><h5>5.2 Have you completed and attached (or emailed/posted):</h5></span></span></div><div class="row-fluid"><span class="span12">    <span  class="span8"><u>For group sponsors and group legal entities:</u></span></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>A financial statement (Departmental template) signed by the Chief Executive Officer and Chief Financial Officer (or equivalent) of the legal entity?<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='If the project was undertaken by a group or a legal entity representing member individuals, indicate whether you have attached the required acquittal documentation.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><select class="span8" data-bind='value:data.groupAuditedDoco,options:transients.groupAuditedDocoConstraints,optionsCaption:"Please select"' data-validation-engine='validate[required]'></select></span></div><div class="row-fluid"><span class="span12">    <span  class="span8"><u>For individuals:</u></span></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>A financial statement prepared by an Independent Qualified Accountant?; and<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='If the project was undertaken in the name of an individual, indicate whether you have attached the required acquittal documentation.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><select class="span8" data-bind='value:data.individualAuditedDoco,options:transients.individualAuditedDocoConstraints,optionsCaption:"Please select"' data-validation-engine='validate[required]'></select></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>A Statutory Declaration?</label></span><select class="span8" data-bind='value:data.individualStatDec,options:transients.individualStatDecConstraints,optionsCaption:"Please select"' data-validation-engine='validate[required]'></select></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel required"><label>A financial statement (Departmental template) signed by the representative of the legal entity?</label></span><select class="span8" data-bind='value:data.individualFinStatement,options:transients.individualFinStatementConstraints,optionsCaption:"Please select"' data-validation-engine='validate[required]'></select></span></div><div class="row-fluid"><span class="span12">    <span  class="span4 preLabel"><label>5.3  If you have additional comments on the project's income, expenditure or budget, please provide them here.<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Please provide any additional comments on the project&apos;s income, expenditure or budget.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></label></span><textarea  class="span8" data-bind='value:data.acquittalNotes'></textarea></span></div></div></div>

        
    </div>
    

    
    
    
    
    <div class="output-block" id="koAttachments">
            <h3 data-bind="css:{modified:dirtyFlag.isDirty},attr:{title:'Has been modified'}">Attachments</h3>
        <!-- add the dynamic components -->
        <div class="row-fluid space-after output-section" >
<div class="span12">
<div class="row-fluid"><span class="span12">    <span  class="span8"><b>Supporting documents: </b> Please attach <b>(via the ADMIN tab)</b> relevant supporting documents (e.g. photos, media clips, survey data, information products/publications, etc.) that provide evidence of the project's progress and / or impacts.</span></span></div><div class="row-fluid"><span class="span12">    <span  class="span8"><b>Additional information (optional): </b> You may attach other documents <b>(via the ADMIN tab)</b> relevant to your project for the Department's information.</span></span></div></div></div>

        
    </div>
    

<!-- /ko -->

</div>




</div>

<script src="static/8ZXRb9eHMwtqVEBpp0Qir69xkJrGMQ3m2qtKB7EFMw4.js" type="text/javascript" ></script>



<script src="static/e9gGniNN5cG3OR4oPVWd5lYoxE5Xf282hFe7d4FTQbq.js" type="text/javascript" ></script>

<script src="static/gfz9yoFSoT3bDIgFJCbjPP9WLeFgekRHSp7KxcpYrwj.js" type="text/javascript" ></script>
<script src="static/3HuXrDXuBUBujUtILOXwtcgC1bibXyjetSOj4LY8YNa.js" type="text/javascript" ></script>





<script src="static/7l2mDQFFpMnG14cXQPTKd94AN71T8yUF6dHUA2LCJIo.js" type="text/javascript" ></script>
<script src="static/ulxBmo4RrKTNT3DuFHethb4EOZpwQfvefxNXivDIbzp.js" type="text/javascript" ></script>








<!--[if gte IE 8]><script src="static/knxjs4G9Cquc79O3iYW107XikPB1Z1ii8QWrtBpzlSP.js" type="text/javascript" ></script><![endif]-->
<script src="static/nRrltgvxdEHd5BqRR1v4XU3ZStOrhDScuH03g4r8E6O.js" type="text/javascript" ></script>

<script src="static/EoDaD63TPT9DIVQTQgpVf0DjZUcnu4E8LTq9uAxdUfP.js" type="text/javascript" ></script>
<script src="static/erSN6TRF3ajakNLLEuDceqCC4TnNnoEJtdAVaq1zjqx.js" type="text/javascript" ></script>
<script src="static/ZbrF5cz3bJrkAqBXLrAlOmoaIYntVDIKpviQs5E8Rhy.js" type="text/javascript" ></script>
<script src="static/IZCc6ZgD3MepYbz4UqlDLzMDNNghSCivcfGebmF9V2d.js" type="text/javascript" ></script>
<script type="text/javascript">
        $(function(){

            var viewModelName = "Final_Report_DetailsViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                    var ParticipatingOrganisationsRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.organisationName = ko.observable(orBlank(data['organisationName']));
            this.organisationType = ko.observable(orBlank(data['organisationType']));
            this.organisationContribution = ko.observable(orBlank(data['organisationContribution']));
        };
        var speciesLists = [];
        var site = {};


            this[viewModelName] = function (output) {
                var self = this;
                self.name = "Final Report Details";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                                self.data.projectGoalsAddressed=ko.observableArray([]);
            self.transients.projectGoalsAddressedConstraints = ["Aquatic and coastal systems","Remnant vegetation","Threatened species","Threatened ecological community","Conservation Estate properties","Migratory species","Ramsar wetlands","National Heritage listed place","World Heritage listed property","Nationally important wetlands","Indigenous cultural values","Community participation and engagement in biodiversity and natural resource management","Sustainable management of the natural resource management base","Soil condition","Ground cover","Other"];
                
        self.loadprojectGoalsAddressed = function (data) {
            if (data !== undefined) {
                $.each(data, function (i, obj) {
                    self.data.projectGoalsAddressed.push(obj);
                });
        }};
        
            self.data.projectGoalsAddressed_Other = ko.observable();

            self.data.achievementsSummary = ko.observable();

            self.data.participatingOrganisations = ko.observableArray([]);
            self.selectedparticipatingOrganisationsRow = ko.observable();
        

            self.loadparticipatingOrganisations = function (data, append) {
                if (!append) {
                    self.data.participatingOrganisations([]);
                }
                if (data === undefined) {
                    self.addparticipatingOrganisationsRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.participatingOrganisations.push(new ParticipatingOrganisationsRow(obj));
                    });
                }
            };

            self.addparticipatingOrganisationsRow = function () {
                var newRow = new ParticipatingOrganisationsRow();
                self.data.participatingOrganisations.push(newRow);
                
            };
            self.removeparticipatingOrganisationsRow = function (row) {
                self.data.participatingOrganisations.remove(row);
                
            };
            self.participatingOrganisationsrowCount = function () {
                return self.data.participatingOrganisations().length;
            };

            self.participatingOrganisationsTableDataUploadVisible = ko.observable(false);
            self.showparticipatingOrganisationsTableDataUpload = function() {
                self.participatingOrganisationsTableDataUploadVisible(!self.participatingOrganisationsTableDataUploadVisible());
            };

            self.participatingOrganisationsTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadparticipatingOrganisations(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "participatingOrganisationstemplate-upload",
                    downloadTemplateId: "participatingOrganisationstemplate-download",
                    formData:{type:'Final Report Details', listName:'participatingOrganisations'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.organisationImpact = ko.observable();

            self.data.achievementsHighlights = ko.observable();

            self.data.monitoringEvaluationLearning = ko.observable();

            self.data.notes = ko.observable();
            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                    
                    delete jsData.activityType;
                    delete jsData.transients;
                    return jsData;
                };

                // this returns a JS object ready for saving
                self.modelForSaving = function () {
                    // get model as a plain javascript object
                    var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                    // get rid of any transient observables
                    return self.removeBeforeSave(jsData);
                };

                // this is a version of toJSON that just returns the model as it will be saved
                // it is used for detecting when the model is modified (in a way that should invoke a save)
                // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
                self.modelAsJSON = function () {
                    return JSON.stringify(self.modelForSaving());
                };

                self.loadData = function (data) {
                    // load dynamic data
                                    self.loadprojectGoalsAddressed(data['projectGoalsAddressed']);
                self.data['projectGoalsAddressed_Other'](data['projectGoalsAddressed_Other']);
                self.data['achievementsSummary'](data['achievementsSummary']);
                self.loadparticipatingOrganisations(data.participatingOrganisations);
                self.data['organisationImpact'](data['organisationImpact']);
                self.data['achievementsHighlights'](data['achievementsHighlights']);
                self.data['monitoringEvaluationLearning'](data['monitoringEvaluationLearning']);
                self.data['notes'](data['notes']);


                    // if there is no data in tables then add an empty row for the user to add data
                    if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                        self.addRow();
                    }
                    self.transients.dummy.notifySubscribers();
                };
            };


            var savedData = activity;
            if (!savedData.outputs) {
                savedData.outputs = [];
            }
            var savedOutput = {};
            if (savedData) {

                $.each(savedData.outputs, function(i, tmpOutput) {
                    if (tmpOutput.name === 'Final Report Details') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            window[viewModelInstance] = new this[viewModelName](savedOutput);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koFinal_Report_Details"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(viewModelInstance, window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

        
        $(function(){

            var viewModelName = "Output_DetailsViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                    var PestManagementRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.pestAnimalsTargetSpecies =  new SpeciesViewModel(data['pestAnimalsTargetSpecies'], speciesLists);
            this.pestAnimalsTreatedNo = ko.observable(orZero(data['pestAnimalsTreatedNo']));
            this.pestAnimalsAreaTreatedHa = ko.observable(orZero(data['pestAnimalsAreaTreatedHa']));
        };
        var WeedManagementRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.weedsTargetSpecies =  new SpeciesViewModel(data['weedsTargetSpecies'], speciesLists);
            this.weedsAreaTreatedHa = ko.observable(orZero(data['weedsAreaTreatedHa']));
        };
        var speciesLists = [];
        var site = {};


            this[viewModelName] = function (output) {
                var self = this;
                self.name = "Output Details";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                
            self.data.areaRevegHa = ko.observable();

            self.data.totalNumberPlanted = ko.observable();

            self.data.percentSurvivalRate = ko.observable();

            self.data.totalSeedCollectedKg = ko.observable();

            self.data.totalNumberGrown = ko.observable();

            self.data.erosionAreaTreated = ko.observable();

            self.data.pestManagement = ko.observableArray([]);
            self.selectedpestManagementRow = ko.observable();
        

            self.loadpestManagement = function (data, append) {
                if (!append) {
                    self.data.pestManagement([]);
                }
                if (data === undefined) {
                    self.addpestManagementRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.pestManagement.push(new PestManagementRow(obj));
                    });
                }
            };

            self.addpestManagementRow = function () {
                var newRow = new PestManagementRow();
                self.data.pestManagement.push(newRow);
                
            };
            self.removepestManagementRow = function (row) {
                self.data.pestManagement.remove(row);
                
            };
            self.pestManagementrowCount = function () {
                return self.data.pestManagement().length;
            };

            self.pestManagementTableDataUploadVisible = ko.observable(false);
            self.showpestManagementTableDataUpload = function() {
                self.pestManagementTableDataUploadVisible(!self.pestManagementTableDataUploadVisible());
            };

            self.pestManagementTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadpestManagement(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "pestManagementtemplate-upload",
                    downloadTemplateId: "pestManagementtemplate-download",
                    formData:{type:'Output Details', listName:'pestManagement'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.weedManagement = ko.observableArray([]);
            self.selectedweedManagementRow = ko.observable();
        

            self.loadweedManagement = function (data, append) {
                if (!append) {
                    self.data.weedManagement([]);
                }
                if (data === undefined) {
                    self.addweedManagementRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.weedManagement.push(new WeedManagementRow(obj));
                    });
                }
            };

            self.addweedManagementRow = function () {
                var newRow = new WeedManagementRow();
                self.data.weedManagement.push(newRow);
                
            };
            self.removeweedManagementRow = function (row) {
                self.data.weedManagement.remove(row);
                
            };
            self.weedManagementrowCount = function () {
                return self.data.weedManagement().length;
            };

            self.weedManagementTableDataUploadVisible = ko.observable(false);
            self.showweedManagementTableDataUpload = function() {
                self.weedManagementTableDataUploadVisible(!self.weedManagementTableDataUploadVisible());
            };

            self.weedManagementTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadweedManagement(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "weedManagementtemplate-upload",
                    downloadTemplateId: "weedManagementtemplate-download",
                    formData:{type:'Output Details', listName:'weedManagement'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.changePracticeTreatedArea = ko.observable();

            self.data.crossTenure = ko.observable();
            self.transients.crossTenureConstraints = ["Yes","No"];

            self.data.skillsDevelopmentActivitiesNo = ko.observable();
                self.data.typeOfCourse=ko.observableArray([]);
            self.transients.typeOfCourseConstraints = ["Vocational - Occupational Health & Safety","Vocational - First aid","Other vocational skills - short course","Science degree or higher"];
                
        self.loadtypeOfCourse = function (data) {
            if (data !== undefined) {
                $.each(data, function (i, obj) {
                    self.data.typeOfCourse.push(obj);
                });
        }};
        
            self.data.lengthOfFence = ko.observable();

            self.data.numberOfEvents = ko.observable();

            self.data.publicSurveysNo = ko.observable();

            self.data.surveysNo = ko.observable();

            self.data.numberOfCommunityGroups = ko.observable();

            self.data.numberOfVolunteers = ko.observable();

            self.data.entitiesAdoptingChange = ko.observable();

            self.data.numberOfFarmingEntitiesParticipating = ko.observable();

            self.data.numberOfIndigenousParticipants = ko.observable();

            self.data.totalIndigenousEmployees = ko.observable();

            self.data.indigenousPlansCompleted = ko.observable();

            self.data.indigenousProductsDeveloped = ko.observable();
            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                    
                    delete jsData.activityType;
                    delete jsData.transients;
                    return jsData;
                };

                // this returns a JS object ready for saving
                self.modelForSaving = function () {
                    // get model as a plain javascript object
                    var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                    // get rid of any transient observables
                    return self.removeBeforeSave(jsData);
                };

                // this is a version of toJSON that just returns the model as it will be saved
                // it is used for detecting when the model is modified (in a way that should invoke a save)
                // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
                self.modelAsJSON = function () {
                    return JSON.stringify(self.modelForSaving());
                };

                self.loadData = function (data) {
                    // load dynamic data
                                    self.data['areaRevegHa'](orZero(data['areaRevegHa']));
                self.data['totalNumberPlanted'](orZero(data['totalNumberPlanted']));
                self.data['percentSurvivalRate'](orZero(data['percentSurvivalRate']));
                self.data['totalSeedCollectedKg'](orZero(data['totalSeedCollectedKg']));
                self.data['totalNumberGrown'](orZero(data['totalNumberGrown']));
                self.data['erosionAreaTreated'](orZero(data['erosionAreaTreated']));
                self.loadpestManagement(data.pestManagement);
                self.loadweedManagement(data.weedManagement);
                self.data['changePracticeTreatedArea'](orZero(data['changePracticeTreatedArea']));
                self.data['crossTenure'](data['crossTenure']);
                self.data['skillsDevelopmentActivitiesNo'](orZero(data['skillsDevelopmentActivitiesNo']));
                self.loadtypeOfCourse(data['typeOfCourse']);
                self.data['lengthOfFence'](orZero(data['lengthOfFence']));
                self.data['numberOfEvents'](orZero(data['numberOfEvents']));
                self.data['publicSurveysNo'](orZero(data['publicSurveysNo']));
                self.data['surveysNo'](orZero(data['surveysNo']));
                self.data['numberOfCommunityGroups'](orZero(data['numberOfCommunityGroups']));
                self.data['numberOfVolunteers'](orZero(data['numberOfVolunteers']));
                self.data['entitiesAdoptingChange'](orZero(data['entitiesAdoptingChange']));
                self.data['numberOfFarmingEntitiesParticipating'](orZero(data['numberOfFarmingEntitiesParticipating']));
                self.data['numberOfIndigenousParticipants'](orZero(data['numberOfIndigenousParticipants']));
                self.data['totalIndigenousEmployees'](orZero(data['totalIndigenousEmployees']));
                self.data['indigenousPlansCompleted'](orZero(data['indigenousPlansCompleted']));
                self.data['indigenousProductsDeveloped'](orZero(data['indigenousProductsDeveloped']));


                    // if there is no data in tables then add an empty row for the user to add data
                    if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                        self.addRow();
                    }
                    self.transients.dummy.notifySubscribers();
                };
            };


            var savedData = activity;
            if (!savedData.outputs) {
                savedData.outputs = [];
            }
            var savedOutput = {};
            if (savedData) {

                $.each(savedData.outputs, function(i, tmpOutput) {
                    if (tmpOutput.name === 'Output Details') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            window[viewModelInstance] = new this[viewModelName](savedOutput);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koOutput_Details"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(viewModelInstance, window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

        
        $(function(){

            var viewModelName = "Project_AcquittalViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                    var speciesLists = [];
        var site = {};


            this[viewModelName] = function (output) {
                var self = this;
                self.name = "Project Acquittal";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                
            self.data.projectAcquittal = ko.observable();
            self.transients.projectAcquittalConstraints = ["Yes","No"];

            self.data.groupAuditedDoco = ko.observable();
            self.transients.groupAuditedDocoConstraints = ["Yes","No","N / A"];

            self.data.individualAuditedDoco = ko.observable();
            self.transients.individualAuditedDocoConstraints = ["Yes","No","N / A"];

            self.data.individualStatDec = ko.observable();
            self.transients.individualStatDecConstraints = ["Yes","No","N / A"];

            self.data.individualFinStatement = ko.observable();
            self.transients.individualFinStatementConstraints = ["Yes","No","N / A"];

            self.data.acquittalNotes = ko.observable();
            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                    
                    delete jsData.activityType;
                    delete jsData.transients;
                    return jsData;
                };

                // this returns a JS object ready for saving
                self.modelForSaving = function () {
                    // get model as a plain javascript object
                    var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                    // get rid of any transient observables
                    return self.removeBeforeSave(jsData);
                };

                // this is a version of toJSON that just returns the model as it will be saved
                // it is used for detecting when the model is modified (in a way that should invoke a save)
                // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
                self.modelAsJSON = function () {
                    return JSON.stringify(self.modelForSaving());
                };

                self.loadData = function (data) {
                    // load dynamic data
                                    self.data['projectAcquittal'](data['projectAcquittal']);
                self.data['groupAuditedDoco'](data['groupAuditedDoco']);
                self.data['individualAuditedDoco'](data['individualAuditedDoco']);
                self.data['individualStatDec'](data['individualStatDec']);
                self.data['individualFinStatement'](data['individualFinStatement']);
                self.data['acquittalNotes'](data['acquittalNotes']);


                    // if there is no data in tables then add an empty row for the user to add data
                    if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                        self.addRow();
                    }
                    self.transients.dummy.notifySubscribers();
                };
            };


            var savedData = activity;
            if (!savedData.outputs) {
                savedData.outputs = [];
            }
            var savedOutput = {};
            if (savedData) {

                $.each(savedData.outputs, function(i, tmpOutput) {
                    if (tmpOutput.name === 'Project Acquittal') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            window[viewModelInstance] = new this[viewModelName](savedOutput);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koProject_Acquittal"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(viewModelInstance, window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

        
        $(function(){

            var viewModelName = "AttachmentsViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                    var speciesLists = [];
        var site = {};


            this[viewModelName] = function (output) {
                var self = this;
                self.name = "Attachments";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                
            self.data. = ko.observable();
            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                    
                    delete jsData.activityType;
                    delete jsData.transients;
                    return jsData;
                };

                // this returns a JS object ready for saving
                self.modelForSaving = function () {
                    // get model as a plain javascript object
                    var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                    // get rid of any transient observables
                    return self.removeBeforeSave(jsData);
                };

                // this is a version of toJSON that just returns the model as it will be saved
                // it is used for detecting when the model is modified (in a way that should invoke a save)
                // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
                self.modelAsJSON = function () {
                    return JSON.stringify(self.modelForSaving());
                };

                self.loadData = function (data) {
                    // load dynamic data
                                    self.data[''](data['']);


                    // if there is no data in tables then add an empty row for the user to add data
                    if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                        self.addRow();
                    }
                    self.transients.dummy.notifySubscribers();
                };
            };


            var savedData = activity;
            if (!savedData.outputs) {
                savedData.outputs = [];
            }
            var savedOutput = {};
            if (savedData) {

                $.each(savedData.outputs, function(i, tmpOutput) {
                    if (tmpOutput.name === 'Attachments') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            window[viewModelInstance] = new this[viewModelName](savedOutput);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koAttachments"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(viewModelInstance, window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

        


    /* Master controller for page. This handles saving each model as required. */
    var Master = function () {
        var self = this;
        this.subscribers = [];
        // client models register their name and methods to participate in saving
        self.register = function (modelInstanceName, getMethod, isDirtyMethod, resetMethod) {
            this.subscribers.push({
                model: modelInstanceName,
                get: getMethod,
                isDirty: isDirtyMethod,
                reset: resetMethod
            });
        };
        // master isDirty flag for the whole page - can control button enabling
        this.isDirty  = function () {
            var dirty = false;
            $.each(this.subscribers, function(i, obj) {
                dirty = dirty || obj.isDirty();
            });
            return dirty;
        };
        /**
         * Makes an ajax call to save any sections that have been modified. This includes the activity
         * itself and each output.
         *
         * Modified outputs are injected as a list into the activity object. If there is nothing to save
         * in the activity itself, then the root is an object that is empty except for the outputs list.
         *
         * NOTE that the model for each section must register itself to be included in this save.
         *
         * Validates the entire page before saving.
         * @return -1 if the page was not modified, 0 if validation failed, 1 if validation succeeded (or was not requested).
         */
        this.save = function (validate) {
            // Ensure any active change is committed - the knockout binding typically fires on blur.
            $( document.activeElement ).blur();

            if (validate === undefined) {
                validate = true;
            }
            var activityData, outputs = [];

            var success = true;
            if (validate) {
                success = $('#validation-container').validationEngine('validate');
            }
            if (!self.isDirty()) {
                mobileBindings.onSaveActivity(-1, null);
                return -1;
            }
            if (success) {
                $.each(this.subscribers, function(i, obj) {
                    if (obj.model === 'activityModel') {
                        activityData = obj.get();
                    } else {
                        outputs.push(obj.get());
                    }
                });

                if (activityData === undefined) { activityData = {}}
                activityData.outputs = outputs;

                var toSave = JSON.stringify(activityData);
                mobileBindings.onSaveActivity(1, toSave);

            }
            else {
                mobileBindings.onSaveActivity(0, null);
            }
            return success?1:0;
        };

        this.reset = function () {
            $.each(this.subscribers, function(i, obj) {
                if (obj.isDirty()) {
                    obj.reset();
                }
            });
        };

        this.addSite = function(site) {
            var viewModel = ko.dataFor(document.getElementById('site'));
            viewModel.transients.sites.push(site);
            viewModel.siteId(site.siteId);
        }
    };

    if (mobileBindings == undefined) {
        var mobileBindings = {
        
            loadActivity:function(){return "{}"},
        
        
            loadSites:function(){return "[]"},
        
        
            loadThemes:function(){return "[]"},
        

        supportsNewSite:function() { return true; },
        onSaveActivity:function(){},
        createNewSite:function(){}
    };
}
var master = new Master();
var activity = JSON.parse(mobileBindings.loadActivity());
var sites = JSON.parse(mobileBindings.loadSites());
var themes = JSON.parse(mobileBindings.loadThemes());

$(function(){

var scroll = false;

    scroll = true;

$('#validation-container').validationEngine('attach', {scroll: scroll});

$('.helphover').popover({animation: true, trigger:'hover'});

$('#reset').click(function () {
master.reset();
});

function ViewModel (act, sites, themes) {
var self = this;
var today = new Date().toISOStringNoMillis();

self.activityId = act.activityId;
self.description = ko.observable(act.description);
self.notes = ko.observable(act.notes);
self.startDate = ko.observable(act.startDate || today).extend({simpleDate: false});
self.endDate = ko.observable(act.endDate).extend({simpleDate: false});
self.plannedStartDate = ko.observable(act.plannedStartDate).extend({simpleDate: false});
self.plannedEndDate = ko.observable(act.plannedEndDate).extend({simpleDate: false});
self.eventPurpose = ko.observable(act.eventPurpose);
self.fieldNotes = ko.observable(act.fieldNotes);
self.associatedProgram = ko.observable(act.associatedProgram);
self.associatedSubProgram = ko.observable(act.associatedSubProgram);
self.progress = ko.observable(act.progress);
self.mainTheme = ko.observable(act.mainTheme);
self.type = ko.observable(act.type);
self.siteId = ko.observable(act.siteId);
self.projectId = act.projectId;
self.transients = {};
self.transients.sites = ko.observableArray(sites);
self.transients.photoPoints = ko.computed(function() {
    var site = $.grep(self.transients.sites(), function(site, index) { return site.siteId == self.siteId(); })[0];
     if (site) {
         return site.photoPoints ? site.photoPoints : site.poi;
     }
     return [];
});
self.transients.activityProgressValues = ['planned','started','finished'];
self.transients.themes = themes?themes:[];
self.transients.markedAsFinished = ko.observable(act.progress === 'finished');
self.transients.markedAsFinished.subscribe(function (finished) {
    self.progress(finished ? 'finished' : 'started');
    if (finished || !self.endDate()) {
        self.endDate(today);
    }
});
self.transients.siteImgUrl = ko.computed(function() {
    if (self.siteId()) {
         var site = $.grep(self.transients.sites(), function(site, index) { return site.siteId == self.siteId(); })[0];
         if (site) {
            var lat,lon;
            if (site.centroidLat !== undefined && site.centroidLon !== undefined) {
                lat = site.centroidLat;
                lon = site.centroidLon;
            }
            else if (site.extent && site.extent.geometry && site.extent.geometry.centre) {
                lat = site.extent.geometry.centre[1];
                lon = site.extent.geometry.centre[0];
            }
            if (lat !== undefined && lon !== undefined) {
                $('#siteLocationImage').show();
                return fcConfig.googleStaticUrl+lat+","+lon;
            }
         }
    }
    return "";
});
self.siteLoadError = function(data, event) {
    $('#siteLocationImage').hide();
};

self.transients.newSiteSupported = ko.observable( mobileBindings.supportsNewSite());

self.modelForSaving = function () {
    // get model as a plain javascript object
    var jsData = ko.toJS(self);
    delete jsData.transients;
    return jsData;
};
self.modelAsJSON = function () {
    return JSON.stringify(self.modelForSaving());
};

self.save = function (callback, key) {
};

self.createNewSite = function() {
    mobileBindings.createNewSite();
}

self.notImplemented = function () {
    alert("Not implemented yet.")
};

self.attachPhotoPoint = function(e) {
    console.log(e);
};
self.dirtyFlag = ko.dirtyFlag(self, false);

// make sure progress moves to started if we save any data (unless already finished)
// (do this here so the model becomes dirty)
self.progress(self.transients.markedAsFinished() ? 'finished' : 'started');
}


var viewModel = new ViewModel(activity, sites, themes);

ko.applyBindings(viewModel);

master.register('activityModel', viewModel.modelForSaving, viewModel.dirtyFlag.isDirty, viewModel.dirtyFlag.reset);


// Workaround for Android bug 6721 - prevents components under the datepicker from receiving clicks on the datepicker.
var disabled = null;
$('[data-bind^=datepicker]').datepicker().on('show', function() {
    if (disabled == null) {
        disabled = $("input:enabled, select:enabled, button:enabled");
        disabled.prop('disabled', true);
    }
});
$('[data-bind^=datepicker]').datepicker().on('hide', function() {
    if (disabled !== null) {
        disabled.prop('disabled', false);
        disabled = null;
    }
});

});


</script>
</body>
</html>
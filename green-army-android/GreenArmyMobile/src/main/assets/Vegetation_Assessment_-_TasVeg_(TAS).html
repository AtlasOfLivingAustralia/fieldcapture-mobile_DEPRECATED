{error=Failed calling web service. class java.io.IOException Server returned HTTP response code: 500 for URL: https://fieldcapture-test.ala.org.au/mobile/activityForm/Vegetation%20Assessment%20-%20TasVeg%20(TAS)?android=true URL= https://fieldcapture-test.ala.org.au/mobile/activityForm/Vegetation%20Assessment%20-%20TasVeg%20(TAS)?android=true., statusCode=500, detail=




<!DOCTYPE html>
<!--[if IE 7]><html lang="en" class="ie ie7"><![endif]-->
<!--[if IE 8]><html lang="en" class="ie ie8"><![endif]-->
<!--[if IE 9]><html lang="en" class="ie ie9"><![endif]-->
<!--[if !IE]><!--><html lang="en"><!--<![endif]-->
<head>
    <title>Grails Runtime Exception</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="static/UGoJGyG3j2UCffTg3vnOdi0FsnS2OvrmrsZD6WxaXGy.js" type="text/javascript" ></script>
<link href="static/Eu8FNKwJJQI8mVJO3VIshatRN1bunflYHvvdqk06tbf.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/090onaZX1M508oSWqGmMeETZ9NkUA9p4CCTW3MUpRPc.css" type="text/css" rel="stylesheet" media="screen, projection" />

<link href="static/CidRUyEAqkZsnDRPRiaGZBy7vd4DOlnRqweu4CsVcIG.css" type="text/css" rel="stylesheet" media="screen" />
<link href="static/tDKPE9VWZfBnSnxBkPC52ml2dXticvlQDl9aR8VpM2o.css" type="text/css" rel="stylesheet" media="screen, projection" />
<!--[if lt IE 7]><link href="static/v1vjA9BeNpSU8cuoTuVhTEUm6boSzwYQcgfPKKMkqgv.css" type="text/css" rel="stylesheet" media="screen, projection" /><![endif]-->

<link href="http://www.ala.org.au/wp-content/themes/ala2011/images/favicon.ico" rel="shortcut icon" />
<!--[if lt IE 9]><script src="static/Yh1Txee3hFzExJ4P1str7tGV24zQMEYtxqtlYJ5ukR0.js" type="text/javascript" ></script><![endif]-->
<link href="static/6tuLClj7N5eYCZpx7vLn8juIbQUXBkCnWRUJFY7UDCz.css" type="text/css" rel="stylesheet" media="screen,print" />
<link href="/static/7ARiB2rJgSkfi68hxnSlcG9Ot0gQ863DYxkCmSHQweE.png" rel="shortcut icon" />
<link href="/static/14SWTr4VqVh6tnlUlgBtue6IJZ7gwE1y42RT7ya5GGW.png" rel="shortcut icon" />

<link href="static/KYGDEVRRaKjNbTXJkHmicmzo9vFrnnzCnGLcxKjR04f.css" type="text/css" rel="stylesheet" media="screen,print" />

<link href="static/uUQBvO5ITMKwLfoRb2u62GbHXEzxtsbrSWq8MBAOrbX.css" type="text/css" rel="stylesheet" media="screen,print" />
<link href="static/Rvy1AbvbH6TVlcTqc4lz71v5o0HJyz9D7Q8u2LCGGX2.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/AcXIjLTuc87n8sfxBjJRQSoBIUwP9RnCyK8Sv82i7eV.css" type="text/css" rel="stylesheet" media="screen, projection" />
<script type="text/javascript">
    var fcConfig = {
        bieUrl: "http://bie.ala.org.au",
        speciesProfileUrl: "https://fieldcapture-test.ala.org.au/proxy/speciesProfile",
        googleStaticUrl:"http://maps.googleapis.com/maps/api/staticmap?maptype=terrian&zoom=12&sensor=false&size=350x250&markers=color:red%7C"
        },
        here = document.location.href;
    </script>
    
		
		<meta name="layout" content="nrm">
		<link rel="stylesheet" href="/static/ZpvQl8LFqnCT7yFUReaIri2ASlUt1FqzRB1qUKtXIdj.css" type="text/css">
	
</head>
<body class="" id="" onload="">



    <div id="announcement">
        <p><font color="red">NOTE:</font> This is a test environment. Any data that you enter in this environment will not be reflected in your real project and may be lost altogether.<br/><font color="red">PLEASE DO NOT ENTER DATA IN THIS ENVIRONMENT.</font></p>
    </div>

<div id="body-wrapper">
    <div class="navbar navbar-inverse navbar-static-top" id="header">
        <div class="navbar-inner">
            <div class="container-fluid">
                <div class="nav logo">
                    <a href="/">
                        <img src="/static/RrjzrZ0Ci0GPLETIr8x8KUMjfJtZKvifrUtMCedwKRB.png" alt="Australian Government Emblem" />
                    </a>
                </div>
                <div class="nav-collapse collapse pull-right">
                    <span class="merit">MERIT</span>
                    <form action="/search/index" method="get" class="search merit" >
                        <p>
                            <label for="keywords"><span class="hide">Full text search</span><input type="text" name="query" id="keywords" value=""></label>
                            <input type="hidden" name="collection" value="agencies">
                            <input type="hidden" name="profile" value="nrm_env">
                            <input type="hidden" name="form" value="simple">
                            <input type="submit" value="search" class="search button">
                        </p>
                    </form>
                </div>
            </div><!--/.container-fluid -->
            
        </div><!--/.navbar-inner -->
    </div><!--/.navbar -->

    <div id="dcNav" class="clearfix ">

        <div class="navbar navbar-inverse container-fluid ">
            
            <ul class="nav">
                <li><a href="/fieldcapture/" class="active hidden-desktop"><i class="icon-home">&nbsp;</i>&nbsp;Home</a></li>
            </ul>
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    <li class=''>
  <a href='/' class='visible-desktop'>
    <i class='icon-home'>&nbsp;</i>&nbsp;Home
  </a>
</li>
<li class=''>
  <a href='/home/about'>
    <i class='icon-info-sign'>&nbsp;</i>&nbsp;About
  </a>
</li>
<li class=''>
  <a href='/home/help'>
    <i class='icon-question-sign'>&nbsp;</i>&nbsp;Help
  </a>
</li>
<li class=''>
  <a href='/home/contacts'>
    <i class='icon-envelope'>&nbsp;</i>&nbsp;Contacts
  </a>
</li>
                </ul>
                <div class="navbar-form pull-right nav-collapse collapse">
                    <span id="buttonBar">
                        
<div class="btn-group">
    <a href='https://auth.ala.org.au/cas/login?service=https://fieldcapture-test.ala.org.au/mobile/activityForm/Vegetation%20Assessment%20-%20TasVeg%20(TAS)' class='btn btn-small btn-inverse btn-login'><span><i class='icon-off icon-white'></i> Log in</span></a>
</div>
                        
                    </span>
                </div>
            </div>
        </div><!-- /.navbar-inner -->
    </div>

    <div id="content" class="clearfix">
        
    <div id="wrapper" class="container-fluid">
        <h1 style="margin:20px 0;">An error occurred</h1>
        
            <h1>Error 500: Internal Server Error</h1>
<dl class="error-details">
<dt>URI</dt><dd>/mobile/activityForm/Vegetation%20Assessment%20-%20TasVeg%20(TAS)</dd>
<dt>Class</dt><dd>java.lang.NullPointerException</dd><dt>Message</dt><dd>Cannot invoke method addClass() on null object</dd></dl><h2>Trace</h2><pre class="stack">   Line | Method
-&gt;&gt; 464 | doFilter in /activity/mobile.gsp
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Caused by GrailsTagException: Error executing tag &lt;md:modelView&gt;: Cannot invoke method addClass() on null object
-&gt;&gt; 140 | doCall   in /WEB-INF/grails-app/views/activity/mobile.gsp
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Caused by NullPointerException: Cannot invoke method addClass() on null object
-&gt;&gt; 167 | dataTag  in au.org.ala.fieldcapture.ModelTagLib
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   226 | dataTag  in     &#39;&#39;
|   619 | doCall . in au.org.ala.fieldcapture.ModelTagLib$_tableViewTemplate_closure17
|   616 | tableViewTemplate in au.org.ala.fieldcapture.ModelTagLib
|   577 | tableBodyEdit in     &#39;&#39;
|   510 | table    in     &#39;&#39;
|   362 | doCall . in au.org.ala.fieldcapture.ModelTagLib$_items_closure8
|   350 | items    in au.org.ala.fieldcapture.ModelTagLib
|   339 | row . .  in     &#39;&#39;
|    50 | doCall   in au.org.ala.fieldcapture.ModelTagLib$_viewModelItems_closure2
|    38 | viewModelItems in au.org.ala.fieldcapture.ModelTagLib
|    31 | doCall   in au.org.ala.fieldcapture.ModelTagLib$_closure1
|    63 | doCall . in gsp_fieldcapture_activitymobile_gsp$_run_closure2
|   131 | run      in gsp_fieldcapture_activitymobile_gsp
|   195 | doFilter in grails.plugin.cache.web.filter.PageFragmentCachingFilter
|    63 | doFilter in grails.plugin.cache.web.filter.AbstractFilter
|   200 | doFilter in au.org.ala.cas.client.UriFilter
|    65 | doFilter in org.jasig.cas.client.session.SingleSignOutFilter
^   701 | run . .  in java.lang.Thread
</pre>
        
        <div class="space-before space-after">&nbsp</div>
	
    </div><!-- /#content -->

    <div id="footer">
        <div id="footer-wrapper">
            <div class="container-fluid">
                <p>While efforts are made to ensure the accuracy of the ecological information contained in MERIT, for confirmation of authoritative data please contact the Department of the Environment.</p><p>This site has been developed by the <a href="http://www.ala.org.au" target="_blank">Atlas of Living Australia</a> in 2013. Please report issues to <strong><a href="mailto:MERIT@environment.gov.au">MERIT@environment.gov.au</a></strong></p>
<div class="large-space-before">Â© 2013 <a href="http://www.nrm.gov.au/about/copyright.html" target="_blank">Commonwealth of Australia</a></div>
            </div>
            <div class="container-fluid">
                <div class="large-space-before">
                    <button class="btn btn-mini" id="toggleFluid">toggle fixed/fluid width</button>
                    
            </div>
        </div>

    </div>
</div><!-- /#body-wrapper -->



<!-- current env = production -->

    


<script src="static/Ttgu9fflIR2OzMMsmkluFvyNHUlZnRJc1rPIIvryZ5N.js" type="text/javascript" ></script>



<script src="static/N1Pu1Yy1dAP26vjRfEw0sZtbZhL03ir303dL4C7EaVF.js" type="text/javascript" ></script>

<script src="static/gfz9yoFSoT3bDIgFJCbjPP9WLeFgekRHSp7KxcpYrwj.js" type="text/javascript" ></script>
<script src="static/HpQC03jqzgdovdmQNni1bswagCkkBPaWGDIzgICGcvq.js" type="text/javascript" ></script>









<!--[if gte IE 8]><script src="static/knxjs4G9Cquc79O3iYW107XikPB1Z1ii8QWrtBpzlSP.js" type="text/javascript" ></script><![endif]-->
<script src="static/kSJb30BxnBzyoP0WndxrtZbaNWzT8x6LP2Cp7xI9PH4.js" type="text/javascript" ></script>
<script src="static/4NNgUS6xThBV2iHZmalcTOp8ioBIjnh2KnVAGLqz5SX.js" type="text/javascript" ></script>
<script src="static/MZjUSqmNLHqbPwhDcAMpejU18pr9ndMRCGKpPBHdSDL.js" type="text/javascript" ></script>
<script src="static/w51VyweI3KQvr6P2DTUzBcR9OpWeX0ktL7UktpeA1k.js" type="text/javascript" ></script>





<script src="static/7l2mDQFFpMnG14cXQPTKd94AN71T8yUF6dHUA2LCJIo.js" type="text/javascript" ></script>
<script src="static/ZbrF5cz3bJrkAqBXLrAlOmoaIYntVDIKpviQs5E8Rhy.js" type="text/javascript" ></script>
<script src="static/IZCc6ZgD3MepYbz4UqlDLzMDNNghSCivcfGebmF9V2d.js" type="text/javascript" ></script>
<script type="text/javascript">
            $(function(){

                var viewModelName = "Benchmarks_-_TASViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                        var speciesLists = [];
        var site = {};


                this[viewModelName] = function (output) {
                    var self = this;
                    self.name = "Benchmarks - TAS";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                
                delete jsData.activityType;
                delete jsData.transients;
                return jsData;
            };

            // this returns a JS object ready for saving
            self.modelForSaving = function () {
                // get model as a plain javascript object
                var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                // get rid of any transient observables
                return self.removeBeforeSave(jsData);
            };

            // this is a version of toJSON that just returns the model as it will be saved
            // it is used for detecting when the model is modified (in a way that should invoke a save)
            // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
            self.modelAsJSON = function () {
                return JSON.stringify(self.modelForSaving());
            };

            self.loadData = function (data) {
                // load dynamic data
                

                // if there is no data in tables then add an empty row for the user to add data
                if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                    self.addRow();
                }
                self.transients.dummy.notifySubscribers();
            };
        };


        var savedData = activity;
        if (!savedData.outputs) {
            savedData.outputs = [];
        }
        var savedOutput = {};
        if (savedData) {

            $.each(savedData.outputs, function(i, tmpOutput) {
                if (tmpOutput.name === 'Benchmarks - TAS') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            window[viewModelInstance] = new this[viewModelName](savedOutput);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koBenchmarks_-_TAS"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(viewModelInstance, window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

            
            $(function(){

                var viewModelName = "Floristic_CompositionViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                        var speciesLists = [];
        var site = {};


                this[viewModelName] = function (output) {
                    var self = this;
                    self.name = "Floristic Composition";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                
                delete jsData.activityType;
                delete jsData.transients;
                return jsData;
            };

            // this returns a JS object ready for saving
            self.modelForSaving = function () {
                // get model as a plain javascript object
                var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                // get rid of any transient observables
                return self.removeBeforeSave(jsData);
            };

            // this is a version of toJSON that just returns the model as it will be saved
            // it is used for detecting when the model is modified (in a way that should invoke a save)
            // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
            self.modelAsJSON = function () {
                return JSON.stringify(self.modelForSaving());
            };

            self.loadData = function (data) {
                // load dynamic data
                

                // if there is no data in tables then add an empty row for the user to add data
                if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                    self.addRow();
                }
                self.transients.dummy.notifySubscribers();
            };
        };


        var savedData = activity;
        if (!savedData.outputs) {
            savedData.outputs = [];
        }
        var savedOutput = {};
        if (savedData) {

            $.each(savedData.outputs, function(i, tmpOutput) {
                if (tmpOutput.name === 'Floristic Composition') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            window[viewModelInstance] = new this[viewModelName](savedOutput);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koFloristic_Composition"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(viewModelInstance, window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

            
            $(function(){

                var viewModelName = "Site_ConditionViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                        var UnderStoreyLifeformsRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.lifeform = ko.observable(orBlank(data['lifeform']));
            this.species =  new SpeciesViewModel(data['species'], speciesLists);
            this.number = ko.observable(orZero(data['number']));
            this.coverPercent = ko.observable(orZero(data['coverPercent']));
            this.present = ko.observable(orFalse(data['present']));
            this.present = ko.observable(orFalse(data['present']));
        };
        var SpeciesRecruitmentRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.species =  new SpeciesViewModel(data['species'], speciesLists);
            this.adequateRecruitment = ko.observable(orFalse(data['adequateRecruitment']));
        };
        var speciesLists = [];
        var site = {};


                this[viewModelName] = function (output) {
                    var self = this;
                    self.name = "Site Condition";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                
            self.data.surveyArea = ko.observable();

            self.data.numberOfLargeTrees = ko.observable();

            self.data.largeTreeCanopyHealthPercent = ko.observable();

            self.data.canopyCoverPercent = ko.observable();

            self.data.canopyHealthPercent = ko.observable();

            self.data.totalWeedCoverPercent = ko.observable();

            self.data.highThreatWeedCoverPercent = ko.observable();

            self.data.underStoreyLifeforms = ko.observableArray([]);
            self.selectedunderStoreyLifeformsRow = ko.observable();
        

            self.loadunderStoreyLifeforms = function (data, append) {
                if (!append) {
                    self.data.underStoreyLifeforms([]);
                }
                if (data === undefined) {
                    self.addunderStoreyLifeformsRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.underStoreyLifeforms.push(new UnderStoreyLifeformsRow(obj));
                    });
                }
            };

            self.addunderStoreyLifeformsRow = function () {
                var newRow = new UnderStoreyLifeformsRow();
                self.data.underStoreyLifeforms.push(newRow);
                
            };
            self.removeunderStoreyLifeformsRow = function (row) {
                self.data.underStoreyLifeforms.remove(row);
                
            };
            self.underStoreyLifeformsrowCount = function () {
                return self.data.underStoreyLifeforms().length;
            };

            self.underStoreyLifeformsTableDataUploadVisible = ko.observable(false);
            self.showunderStoreyLifeformsTableDataUpload = function() {
                self.underStoreyLifeformsTableDataUploadVisible(!self.underStoreyLifeformsTableDataUploadVisible());
            };

            self.underStoreyLifeformsTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadunderStoreyLifeforms(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "underStoreyLifeformstemplate-upload",
                    downloadTemplateId: "underStoreyLifeformstemplate-download",
                    formData:{type:'Site Condition', listName:'underStoreyLifeforms'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.speciesRecruitment = ko.observableArray([]);
            self.selectedspeciesRecruitmentRow = ko.observable();
        

            self.loadspeciesRecruitment = function (data, append) {
                if (!append) {
                    self.data.speciesRecruitment([]);
                }
                if (data === undefined) {
                    self.addspeciesRecruitmentRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.speciesRecruitment.push(new SpeciesRecruitmentRow(obj));
                    });
                }
            };

            self.addspeciesRecruitmentRow = function () {
                var newRow = new SpeciesRecruitmentRow();
                self.data.speciesRecruitment.push(newRow);
                
            };
            self.removespeciesRecruitmentRow = function (row) {
                self.data.speciesRecruitment.remove(row);
                
            };
            self.speciesRecruitmentrowCount = function () {
                return self.data.speciesRecruitment().length;
            };

            self.speciesRecruitmentTableDataUploadVisible = ko.observable(false);
            self.showspeciesRecruitmentTableDataUpload = function() {
                self.speciesRecruitmentTableDataUploadVisible(!self.speciesRecruitmentTableDataUploadVisible());
            };

            self.speciesRecruitmentTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadspeciesRecruitment(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "speciesRecruitmenttemplate-upload",
                    downloadTemplateId: "speciesRecruitmenttemplate-download",
                    formData:{type:'Site Condition', listName:'speciesRecruitment'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.recruitmentDiversity = ko.observable();
            self.transients.recruitmentDiversityConstraints = ["No evidence of recruitment","< 30% adequate","30% - 70% adequate",">= 70% adequate"];

            self.data.organicLitterCoverPercent = ko.observable();

            self.data.averageLogLength = ko.observable();

            self.data.largeTreesScore = ko.observable();

            self.data.canopyCoverScore = ko.observable();

            self.data.weedScore = ko.observable();

            self.data.understoreyScore = ko.observable();

            self.data.recruitmentScore = ko.observable();

            self.data.organicLitterScore = ko.observable();

            self.data.logScore = ko.observable();

            self.data.benchmarkTreesPerHa = ko.observable();
            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                                delete jsData.selectedunderStoreyLifeformsRow;
                delete jsData.underStoreyLifeformsTableDataUploadOptions
                delete jsData.underStoreyLifeformsTableDataUploadVisible

                delete jsData.activityType;
                delete jsData.transients;
                return jsData;
            };

            // this returns a JS object ready for saving
            self.modelForSaving = function () {
                // get model as a plain javascript object
                var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                // get rid of any transient observables
                return self.removeBeforeSave(jsData);
            };

            // this is a version of toJSON that just returns the model as it will be saved
            // it is used for detecting when the model is modified (in a way that should invoke a save)
            // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
            self.modelAsJSON = function () {
                return JSON.stringify(self.modelForSaving());
            };

            self.loadData = function (data) {
                // load dynamic data
                                self.data['surveyArea'](orZero(data['surveyArea']));
                self.data['numberOfLargeTrees'](orZero(data['numberOfLargeTrees']));
                self.data['largeTreeCanopyHealthPercent'](orZero(data['largeTreeCanopyHealthPercent']));
                self.data['canopyCoverPercent'](orZero(data['canopyCoverPercent']));
                self.data['canopyHealthPercent'](orZero(data['canopyHealthPercent']));
                self.data['totalWeedCoverPercent'](orZero(data['totalWeedCoverPercent']));
                self.data['highThreatWeedCoverPercent'](orZero(data['highThreatWeedCoverPercent']));
                self.loadunderStoreyLifeforms(data.underStoreyLifeforms);
                self.loadspeciesRecruitment(data.speciesRecruitment);
                self.data['recruitmentDiversity'](data['recruitmentDiversity']);
                self.data['organicLitterCoverPercent'](orZero(data['organicLitterCoverPercent']));
                self.data['averageLogLength'](orZero(data['averageLogLength']));
                self.data['largeTreesScore'](orZero(data['largeTreesScore']));
                self.data['canopyCoverScore'](orZero(data['canopyCoverScore']));
                self.data['weedScore'](orZero(data['weedScore']));
                self.data['understoreyScore'](orZero(data['understoreyScore']));
                self.data['recruitmentScore'](orZero(data['recruitmentScore']));
                self.data['organicLitterScore'](orZero(data['organicLitterScore']));
                self.data['logScore'](orZero(data['logScore']));
                self.data['benchmarkTreesPerHa'](orZero(data['benchmarkTreesPerHa']));


                // if there is no data in tables then add an empty row for the user to add data
                if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                    self.addRow();
                }
                self.transients.dummy.notifySubscribers();
            };
        };


        var savedData = activity;
        if (!savedData.outputs) {
            savedData.outputs = [];
        }
        var savedOutput = {};
        if (savedData) {

            $.each(savedData.outputs, function(i, tmpOutput) {
                if (tmpOutput.name === 'Site Condition') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            window[viewModelInstance] = new this[viewModelName](savedOutput);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koSite_Condition"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(viewModelInstance, window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

            
    // Prevent console.log() killing IE
    if (typeof console == "undefined") {
        this.console = {log: function() {}};
    }

    $(document).ready(function (e) {

        $.ajaxSetup({ cache: false });

        $("#btnLogout").click(function (e) {
            window.location = "/logout/index";
        });

        $(".btnAdministration").click(function (e) {
            window.location = "/admin/index";
        });
        $('#btnDashboard').click(function(e) {
            window.location = "/report/dashboard"
        });

        $(".btnProfile").click(function (e) {
            window.location = "/myProfile";
        });

        $("#toggleFluid").click(function(el){
            var fluidNo = $('div.container-fluid').length;
            var fixNo = $('div.container').length;
            //console.log("counts", fluidNo, fixNo);
            if (fluidNo > fixNo) {
                $('div.container-fluid').addClass('container').removeClass('container-fluid');
            } else {
                $('div.container').addClass('container-fluid').removeClass('container');
            }
        });

        // Set up a timer that will periodically poll the server to keep the session alive
        var intervalSeconds = 5 * 60;

        setInterval(function() {
            $.ajax("/ajax/keepSessionAlive").done(function(data) {});
        }, intervalSeconds * 1000);

    }); // end document ready



        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-4355440-1']);
        _gaq.push(['_setDomainName', 'ala.org.au']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>
</body>
</html>}